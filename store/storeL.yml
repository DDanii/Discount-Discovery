autoCorrectYears: true
name: Lidl
steps:
  - stepParameters: 
      method: Literal
      data: "https://www.lidl.hu/q/api/search?q=*&locale=hu_HU&assortment=HU&version=2.1.0&fetchsize=100"
      destination: link
  - stepParameters: 
      method: Literal
      data: ""
      destination: empty
  - stepParameters: 
      method: Literal
      data: .
  - stepParameters: 
      method: Concat
      first: currentYear
  - stepParameters: 
      method: SetProp
      destination: currentYear
  - stepParameters:
      method: CreateArray
      name: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=0"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=100"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=200"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=300"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=400"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=500"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=600"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=700"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=800"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=900"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1000"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1100"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1200"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1300"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1400"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1500"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1600"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1700"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1800"
  - stepParameters: 
      method: PushToArray
      array: linkArray
  - stepParameters: 
      method: Literal
      data: "&offset=1900"
  - stepParameters: 
      method: PushToArray
      array: linkArray

  - stepParameters: 
      method: ForEach
      source: linkArray
      steps:
        - stepParameters: 
            method: Concat
            first: link
        - stepParameters: 
            method: Fetch
        - stepParameters: 
            method: ParseJSON
        - stepParameters: 
            method: SetProp
            source: data.items
            destination: items
        - stepParameters: 
            method: If
            data: items
            steps:
              - stepParameters: 
                  method: ForEach
                  source: items
                  steps:
                      - stepParameters: 
                          method: SetProp
                          source: data.code
                          destination: product.externalId
                      - stepParameters: 
                          method: SetProp
                          source: data.label
                          destination: product.name
                      - stepParameters: 
                          method: SetProp
                          source: data.gridbox.data.image
                          destination: product.image
                      - stepParameters: 
                          method: SetProp
                          destination: tmp
                      - stepParameters: 
                          method: DeepCopy
                      - stepParameters: 
                          method: SetProp
                          source: data.gridbox.data.price.price
                          destination: product.price
                      - stepParameters:
                          method: SetProp
                          source: data.gridbox.data.keyfacts.analyticsCategory
                          destination: product.category
                      - stepParameters: 
                          method: SetProp
                          source: data.gridbox.data.stockAvailability
                      - stepParameters: 
                          method: If
                          steps:
                          - stepParameters: 
                              method: SetProp
                              source: badgeInfo.badges.0.text
                          - stepParameters: 
                              method: Split
                              separator: ": "
                          - stepParameters: 
                              method: SetProp
                              source: data.1
                          - stepParameters: 
                              method: If
                              steps:
                                  - stepParameters: 
                                      method: SetProp
                                      destination: dateTmp
                                  - stepParameters: 
                                      method: Split
                                      separator: " - "
                                  - stepParameters: 
                                      method: SetProp
                                      source: data.1
                                  - stepParameters: 
                                      method: If
                                      steps:
                                          - stepParameters: 
                                              method: Concat
                                              first: currentYear
                                          - stepParameters: 
                                              method: SetProp
                                              destination: product.endDate
                                          - stepParameters: 
                                              method: SetProp
                                              source: dateTmp
                                          - stepParameters: 
                                              method: Split
                                              separator: " - "
                                          - stepParameters: 
                                              method: Concat
                                              first: currentYear
                                              second: data.0
                                          - stepParameters: 
                                              method: SetProp
                                              destination: product.startDate
                                      elseSteps:
                                          - stepParameters: 
                                              method: SetProp
                                              source: empty
                                              destination: product.startDate
                          - stepParameters: 
                              method: PushToArray
                              array: DDParsedProducts
                              data: product
    